{"kind": "serving", "metadata": {"name": "model-serving", "tag": "", "hash": "736579e1911348f65025b7ccc9f69d602dc1a4b2", "project": "nyc-taxi-gilad", "categories": [], "credentials": {"access_key": "2ba89e7a-f854-4b15-9842-4c009383f015"}}, "spec": {"command": "", "args": [], "image": "mlrun/mlrun", "build": {"commands": ["pip install lightgbm"], "code_origin": "/User/demos/howto/converting-to-mlrun/model-serving.ipynb", "origin_filename": "/User/demos/howto/converting-to-mlrun/model-serving.ipynb"}, "description": "", "default_handler": "", "disable_auto_mount": false, "env": [{"name": "V3IO_API", "value": ""}, {"name": "V3IO_USERNAME", "value": ""}, {"name": "V3IO_ACCESS_KEY", "value": ""}, {"name": "V3IO_FRAMESD", "value": ""}, {"name": "MLRUN_AUTH_SESSION", "value": "2ba89e7a-f854-4b15-9842-4c009383f015"}], "priority_class_name": "igz-workload-medium", "preemption_mode": "prevent", "min_replicas": 1, "max_replicas": 4, "config": {"metadata.labels.mlrun/class": "serving", "spec.serviceType": "ClusterIP", "spec.priorityClassName": "igz-workload-medium", "spec.minReplicas": 1, "spec.maxReplicas": 4}, "base_spec": {"apiVersion": "nuclio.io/v1", "kind": "Function", "metadata": {"annotations": {"nuclio.io/generated_by": "function generated from /User/demos/howto/converting-to-mlrun/model-serving.ipynb"}, "labels": {"mlrun/class": "serving", "nuclio.io/project-name": "nyc-taxi-gilad"}, "name": "nyc-taxi-gilad-model-serving"}, "spec": {"build": {"commands": ["pip install lightgbm"], "functionSourceCode": "IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IG1scnVuCmltcG9ydCBvcwoKaW1wb3J0IG51bXB5IGFzIG5wCmZyb20gY2xvdWRwaWNrbGUgaW1wb3J0IGxvYWQKCmNsYXNzIExHQk1Nb2RlbChtbHJ1bi5zZXJ2aW5nLlYyTW9kZWxTZXJ2ZXIpOgogICAgCiAgICBkZWYgbG9hZChzZWxmKToKICAgICAgICBtb2RlbF9maWxlLCBleHRyYV9kYXRhID0gc2VsZi5nZXRfbW9kZWwoJy5wa2wnKQogICAgICAgIHNlbGYubW9kZWwgPSBsb2FkKG9wZW4obW9kZWxfZmlsZSwgJ3JiJykpCgogICAgZGVmIHByZWRpY3Qoc2VsZiwgYm9keSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmZWF0cyA9IG5wLmFzYXJyYXkoYm9keVsnaW5wdXRzJ10pCiAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYubW9kZWwucHJlZGljdChmZWF0cykKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC50b2xpc3QoKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCJGYWlsZWQgdG8gcHJlZGljdCAlcyIgJSBlKQoKCmZyb20gbWxydW4ucnVudGltZXMgaW1wb3J0IG51Y2xpb19pbml0X2hvb2sKZGVmIGluaXRfY29udGV4dChjb250ZXh0KToKICAgIG51Y2xpb19pbml0X2hvb2soY29udGV4dCwgZ2xvYmFscygpLCAnc2VydmluZ192MicpCgpkZWYgaGFuZGxlcihjb250ZXh0LCBldmVudCk6CiAgICByZXR1cm4gY29udGV4dC5tbHJ1bl9oYW5kbGVyKGNvbnRleHQsIGV2ZW50KQo=", "noBaseImagesPull": true, "baseImage": "datanode-registry.iguazio-platform.app.cust-cs-3-2-3.iguazio-cd2.com:80/quay.io/mlrun/mlrun:0.10.2-rc1"}, "env": [{"name": "V3IO_API", "value": "v3io-webapi.default-tenant.svc:8081"}, {"name": "V3IO_USERNAME", "value": "Gilad"}, {"name": "V3IO_ACCESS_KEY", "value": "2ba89e7a-f854-4b15-9842-4c009383f015"}, {"name": "V3IO_FRAMESD", "value": "framesd:8081"}, {"name": "MLRUN_AUTH_SESSION", "value": "2ba89e7a-f854-4b15-9842-4c009383f015"}, {"name": "MLRUN_DEFAULT_PROJECT", "value": "nyc-taxi-gilad"}, {"name": "MLRUN_DBPATH", "value": "http://mlrun-api:8080"}, {"name": "MLRUN_NAMESPACE", "value": "default-tenant"}, {"name": "SERVING_SPEC_ENV", "value": "{\"function_uri\": \"nyc-taxi-gilad/model-serving\", \"version\": \"v2\", \"parameters\": {}, \"graph\": {\"kind\": \"router\", \"routes\": {\"taxi-serving\": {\"kind\": \"task\", \"class_name\": \"LGBMModel\", \"class_args\": {\"model_path\": \"store://artifacts/nyc-taxi-gilad/train_model_FareModel:962f4de29b9146519277514bd3a7e552\"}}}}, \"load_mode\": null, \"functions\": {}, \"graph_initializer\": null, \"error_stream\": null, \"track_models\": null, \"default_content_type\": null}"}], "handler": "model-serving:handler", "runtime": "python:3.6", "volumes": [{"volume": {"flexVolume": {"driver": "v3io/fuse", "options": {"accessKey": "2ba89e7a-f854-4b15-9842-4c009383f015"}}, "name": "v3io"}, "volumeMount": {"mountPath": "/v3io", "name": "v3io", "subPath": ""}}, {"volume": {"flexVolume": {"driver": "v3io/fuse", "options": {"accessKey": "2ba89e7a-f854-4b15-9842-4c009383f015"}}, "name": "v3io"}, "volumeMount": {"mountPath": "/User", "name": "v3io", "subPath": "users/Gilad"}}], "serviceType": "ClusterIP", "priorityClassName": "igz-workload-medium", "minReplicas": 1, "maxReplicas": 4, "triggers": {"http": {"kind": "http", "name": "http", "maxWorkers": 1, "workerAvailabilityTimeoutMilliseconds": 10000, "attributes": {"ingresses": {"0": {"paths": ["/"], "hostTemplate": "@nuclio.fromDefault"}}, "serviceType": "ClusterIP"}}}}}, "source": "", "function_kind": "serving_v2", "graph": {"kind": "router", "routes": {"taxi-serving": {"kind": "task", "class_name": "LGBMModel", "class_args": {"model_path": "store://artifacts/nyc-taxi-gilad/train_model_FareModel:962f4de29b9146519277514bd3a7e552"}}}}, "default_class": "LGBMModel", "secret_sources": [], "affinity": null, "tolerations": null}, "verbose": false}